{% extends "base2.html" %}
{% load static %}

{% block title %} Quản lý đơn hàng {% endblock %}

{% block content %}
<!-- Begin Page Content -->
                <div class="container-fluid">

                    <!-- Page Heading -->
                    <h1 class="h3 mb-2 text-gray-800">Quản lý đơn hàng</h1>

                    <!-- DataTales Example -->
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">Danh sách đơn hàng</h6>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                                    <thead>
                                        <tr>
                                            <th>Tên người nhận</th>
                                            <th>Địa chỉ</th>
                                            <th>Số điện thoại</th>
                                            <th>Ngày đặt hàng</th>
                                            <th>Tổng tiền</th>
                                            <th>Trạng thái</th>
                                            <th>Thao tác</th>
                                        </tr>
                                    </thead>
                                    <tfoot>
                                        <tr>
                                            <th>Tên người nhận</th>
                                            <th>Địa chỉ</th>
                                            <th>Số điện thoại</th>
                                            <th>Ngày đặt hàng</th>
                                            <th>Tổng tiền</th>
                                            <th>Trạng thái</th>
                                            <th>Thao tác</th>
                                        </tr>
                                    </tfoot>
                                    <tbody>
                                    {% for dh in list_dh %}
                                        <tr>
                                            <td>{{ dh.iduser.username }}</td>
                                            <td>{{ dh.diachi }}</td>
                                            <td>{{ dh.sodienthoai }}</td>
                                            <td>{{ dh.ngaydathang }}</td>
                                            <td>{{ dh.tongtien }}</td>
                                            <td>{{ dh.trangthai }}</td>
                                            <td>{% if dh.trangthai == 0 %}
                                                <form action="{% url 'thaotacdh' id=dh.id action=1 %}" method="post">
                                                    {% csrf_token %}
                                                    <button class="btn btn-primary" type="submit">Xác nhận đơn hàng</button>
                                                </form>
                                                <form action="{% url 'thaotacdh' id=dh.id action=2 %}" method="post">
                                                    {% csrf_token %}
                                                    <button class="btn btn-danger" type="submit">Hủy đơn hàng</button>
                                                </form>
                                                {% elif dh.trangthai == 1 %}
                                                <form action="{% url 'thaotacdh' id=dh.id action=1 %}" method="post">
                                                    {% csrf_token %}
                                                    <button class="btn btn-primary" type="submit">Xác nhận giao hàng</button>
                                                </form>
                                                <form action="{% url 'thaotacdh' id=dh.id action=2 %}" method="post">
                                                    {% csrf_token %}
                                                    <button class="btn btn-danger" type="submit">Hủy đơn hàng</button>
                                                </form>
                                                {% elif dh.trangthai == 2 %}
                                                <form action="{% url 'thaotacdh' id=dh.id action=1 %}" method="post">
                                                    {% csrf_token %}
                                                    <button class="btn btn-primary" type="submit">Xác nhận nhận hàng</button>
                                                </form>
                                                <form action="{% url 'thaotacdh' id=dh.id action=2 %}" method="post">
                                                    {% csrf_token %}
                                                    <button class="btn btn-danger" type="submit">Hủy đơn hàng</button>
                                                </form>
                                                {% elif dh.trangthai == 3 %}
                                                    <p>Đã hoàn thành</p>
                                                {% else %}
                                                    <p>Đơn hàng đã hủy</p>
                                                {% endif %}
                                            </td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                </div>
                <!-- /.container-fluid -->
{% endblock %}
{% block reqjs %}
<!-- Page level plugins -->
<script src="{% static 'vendor/datatables/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'vendor/datatables/dataTables.bootstrap4.min.js' %}"></script>

<!-- Page level custom scripts -->
<script src="{% static 'js/demo/datatables-demo.js' %}"></script>
{% endblock %}